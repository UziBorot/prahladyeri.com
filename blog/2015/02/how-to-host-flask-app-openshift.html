<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <title>How to host a Flask app on Openshift</title>
        <link rel="stylesheet" href="https://prahladyeri.com/theme/css/main.css" />
        <link href="https://prahladyeri.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Prahlad Yeri - Freelance Programmer Atom Feed" />
		
	<meta name="twitter:card" content="summary" />
	 <meta name="twitter:site" content="@prahladyeri" />
	 <meta name="twitter:creator" value="@prahladyeri" />
		<meta name="twitter:url" content="blog/2015/02/how-to-host-flask-app-openshift.html" />
	 	 <meta name="twitter:title" content="How to host a Flask app on Openshift" />
		<meta name="twitter:description" content="<p><em>Note: This article may no longer be relevant as Red Hat has recently changed the openshift stack with docker and kubernetes.</em></p>
<p><a href="https://www.openshift.com/">Openshift free tier</a> is an excellent way to host your python web app for staging or testing, and you can even host a low to medium traffic production site …</p>" />		
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://prahladyeri.com/">Prahlad Yeri - Freelance Programmer </a></h1>
                <nav><ul>
				<li><a href="/">Home</a></li> <!--hard coded-->
                    <li><a href="https://prahladyeri.com/about/">About</a></li>
                    <li><a href="https://prahladyeri.com/projects/">Projects</a></li>
                    <li><a href="https://prahladyeri.com/hire-me/">Hire Me</a></li>
				<li><a href="https://github.com/prahladyeri/resume">Resume</a></li> <!--hard coded-->
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://prahladyeri.com/blog/2015/02/how-to-host-flask-app-openshift.html" rel="bookmark"
           title="Permalink to How to host a Flask app on Openshift">How to host a Flask app on Openshift</a></h1>
<a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="prahladyeri">Tweet</a><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-02-06T18:30:00+05:30">
                Published: Fri 06 February 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://prahladyeri.com/author/prahlad-yeri.html">Prahlad Yeri</a>
        </address>
<p>In <a href="https://prahladyeri.com/category/python.html">Python</a>.</p>
<p>tags: <a href="https://prahladyeri.com/tag/python.html">Python</a> <a href="https://prahladyeri.com/tag/flask.html">Flask</a> <a href="https://prahladyeri.com/tag/openshift.html">Openshift</a> </p>
</footer><!-- /.post-info -->      <p><em>Note: This article may no longer be relevant as Red Hat has recently changed the openshift stack with docker and kubernetes.</em></p>
<p><a href="https://www.openshift.com/">Openshift free tier</a> is an excellent way to host your python web app for staging or testing, and you can even host a low to medium traffic production site. Openshift provides several options (cartridges) for hosting including <code>python, php, node.js, etc.</code> but <code>python</code> being my favorite language and <code>Flask</code> being a minimalist and flexible framework, this combination is what I usually end up with.<!--more--></p>
<h3>Create an Openshift account</h3>
<p>In case you haven’t already, head over to <a href="https://www.openshift.com/">Openshift</a> and sign up for a free tier. You will be able to host at most three apps for each account. Openshift apps are hosted on <code>rhcloud.com</code> domain and you’ll have to setup a subdomain first which will be part of your app url. For instance, if I register <code>prahladyeri.rhcloud.com</code> subdomain, I can create the following apps with that:</p>
<div class="highlight"><pre><span></span>myflaskapp-prahladyeri.rhcloud.com
myphpapp-prahladyeri.rhcloud.com
blog-prahladyeri.rhcloud.com
</pre></div>


<h3>Install the necessary tools</h3>
<p>You will need the following:</p>
<ol>
<li><a href="git-scm.com/">Git</a>: Your app resides in a git repository, so you’ll need git installed on your machine to push changes. App is deployed automatically once you push.</li>
<li><a href="http://python.org">Python and Flask</a>: Obviously, you are going to need them if you are building a Flask app.</li>
<li><a href="https://rubygems.org/gems/rhc">Openshift rhc tool</a>: This <code>ruby</code> based tool is optional, only use it if you don’t want to use their online portal for creating apps or you aren’t familiar with ssh. Personally, I didn’t want to install <code>ruby</code> on my machine just for this one purpose.</li>
</ol>
<h3>Pull the remote repo</h3>
<p>Once you create a python app, Openshift will provide you a git repository url as follows:</p>
<p><img alt="Openshift git url" src="/uploads/old/openshift-git-repo.png"></p>
<p>Now open your command line and pull this starter repo to your local machine:</p>
<div class="highlight"><pre><span></span>git clone &lt;YOUR_SOURCE_URL&gt; myFlaskApp
</pre></div>


<p>Now, the remote repository will be cloned in the <code>myFlaskApp</code> folder. Browse it to see the scaffolding.</p>
<h3>Add your flask app</h3>
<p>The scaffolding structure will be as follows:</p>
<div class="highlight"><pre><span></span>wsgi.py
setup.py
.openshift/..
.settings/..
wsgi/..         =&gt; your python source files go here.
wsgi/static..   =&gt; your static folders viz css, img, fonts, et al. go here.
</pre></div>


<p>If the wsgi/ folder doesn’t exist, you’ll have to create it. Just modify the setup.py and add Flask and SQLAlchemy as your app dependencies along with your app name. This tells openshift to make sure that dependency packages are available whenever you push any code changes.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;myFlaskApp&#39;</span><span class="p">,</span>
      <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="s1">&#39;myFlaskApp&#39;</span><span class="p">,</span>
      <span class="n">author</span><span class="o">=</span><span class="s1">&#39;Prahlad Yeri&#39;</span><span class="p">,</span>
      <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;prahladyeri@yahoo.com&#39;</span><span class="p">,</span>
      <span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://www.python.org/sigs/distutils-sig/&#39;</span><span class="p">,</span>
      <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Flask==0.10.1&#39;</span><span class="p">,</span><span class="s1">&#39;SQLAlchemy==0.9.8&#39;</span><span class="p">],</span>
     <span class="p">)</span>
</pre></div>


<p>Now, create a text file named <code>application</code> in the wsgi/ folder with the following contents:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">virtenv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OPENSHIFT_PYTHON_DIR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/virtenv/&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHON_EGG_CACHE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">virtenv</span><span class="p">,</span> <span class="s1">&#39;lib/python2.7/site-packages&#39;</span><span class="p">)</span>
<span class="n">virtualenv</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">virtenv</span><span class="p">,</span> <span class="s1">&#39;bin/activate_this.py&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">execfile</span><span class="p">(</span><span class="n">virtualenv</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="vm">__file__</span><span class="o">=</span><span class="n">virtualenv</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="kn">from</span> <span class="nn">myFlaskApp</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">application</span>
</pre></div>
</td></tr></table>

<p>This is a configuration file that tells openshift where your Flask app script resides. Now create a python file called myFlaskApp.py, this will be your HelloWorld script:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flask</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello World&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<p>The last part of the code (app.run) is there so that you may test the Flask app by running this script on your local machine before pushing these changes.</p>
<h3>Push your changes</h3>
<p>All that is left to be done now is committing your changes and pushing them to openshift:</p>
<div class="highlight"><pre><span></span>git add .
git commit -m &quot;Initial commit for myFlaskApp&quot;
git push origin master
</pre></div>


<h3>Voila! You are done</h3>
<p>Wasn’t it almost as easy as deploying a <code>php</code> script on your web host? If everything goes right, your Flask app will be hosted on <code>http://myFlaskApp-mydomain.rhcloud.com/</code>. Visit your app link and check it out.</p>
<h3>Few important things</h3>
<ul>
<li>In case you aren’t familiar about how git over ssl works, the remote machine authenticates your machine using an SSL public key you have already provided them. So if this is your fist time, you’ll have to generate a private-public key pair (using ssh in linux or putty on windows). After that, you’ll have to update your public key to Openshift, so they can authenticate your machine. You can add it using the Settings menu on the Openshift portal.</li>
<li>Its very important that all your static files reside in <strong>wsgi/static</strong> folder and that folder only. Openshift uses that path by default. But in case you are really stuck with using <code>/css</code> and <code>/js</code> in your existing app, as a solution you can clear the <code>static_url_path</code> in your flask app as follows:<div class="highlight"><pre><span></span>app = Flask(__name__, static_url_path=&#39;&#39;, static_folder=&#39;static&#39;)
</pre></div>


</li>
</ul>
<p>Refer to this Openshift <a href="https://blog.openshift.com/build-your-app-on-openshift-using-flask-sqlalchemy-and-postgresql-92/">tutorial</a> for more details.</p>
<ul>
<li>Make the most of SSH. Some times, you may want to connect with the remote server using secured shell (ssh/putty) for troubleshooting, viewing logs, etc. Your SSH url is included in your git source url. So, if your git url is of the form:<div class="highlight"><pre><span></span>ssh://500XXXXXXXXXXXX01061a@prahladyeri-inn.rhcloud.com/~/git/prahladyeri.git/
</pre></div>


</li>
</ul>
<p>Just remove the <code>ssh://</code> from the beginning and the other things after the domain, so the SSH host url becomes:</p>
<div class="highlight"><pre><span></span>500XXXXXXXXXXXX01061a@prahladyeri-inn.rhcloud.com
</pre></div>


<p><em>References:</em></p>
<ul>
<li><a href="https://blog.openshift.com/build-your-app-on-openshift-using-flask-sqlalchemy-and-postgresql-92/">Build an app using Flask, SQLAlchemy and PostgreSQL</a></li>
<li><a href="https://rubygems.org/gems/rhc">Openshift rhc tool</a></li>
<li><a href="https://www.openshift.com/">Openshift Homepage</a></li>
</ul>
    </div><!-- /.entry-content -->
	
	<!-- Start: Prahlad -->
	<!--start: adsense-->
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- mainsite_responsive -->
	<ins class="adsbygoogle"
		 style="display:block"
		 data-ad-client="ca-pub-0428291735937735"
		 data-ad-slot="6897031752"
		 data-ad-format="auto"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	<!--end: adsense-->
	<!-- End: Prahlad -->

    <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
		<script>
		/**
		*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
		
		/*var disqus_config = function () {
			this.page.url = 'https://prahladyeri.com/blog/2015/02/how-to-host-flask-app-openshift.html';  // Replace PAGE_URL with your page's canonical URL variable
			this.page.identifier = 'blog/2015/02/how-to-host-flask-app-openshift.html'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
		};
		(function() { // DON'T EDIT BELOW THIS LINE
		var d = document, s = d.createElement('script');
		s.src = 'https://prahladyeri-blog.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
		})();*/
		</script>	  
	  
      <script type="text/javascript">
        var disqus_shortname = 'prahladyeri-blog';
        var disqus_identifier = 'blog/2015/02/how-to-host-flask-app-openshift.html';
        var disqus_url = 'https://prahladyeri.com/blog/2015/02/how-to-host-flask-app-openshift.html';
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//prahladyeri-blog.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="mailto:prahladyeri@yahoo.com">Email</a></li>
                            <li><a href="https://github.com/prahladyeri/">Github</a></li>
                            <li><a href="https://stackoverflow.com/users/849365/prahlad-yeri/">StackOverflow</a></li>
                            <li><a href="https://www.quora.com/profile/Prahlad-Yeri">Quora</a></li>
                            <li><a href="https://mastodon.social/@prahladyeri">Mastodon.Social</a></li>
                            <li><a href="https://www.blogger.com/profile/12769325975373447545">Blogger</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://prahladyeri.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/prahlad-yeri-243a5316">Linkedin</a></li>
                            <li><a href="https://www.facebook.com/prahladyeri14">Facebook</a></li>
                            <li><a href="https://twitter.com/prahladyeri">Twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Copyright (c) 2013-2019 <a href="/">Prahlad Yeri</a>.
				<br>
				This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6808883-5', 'auto');
    ga('send', 'pageview');
    </script>
<script type="text/javascript">
    var disqus_shortname = 'prahladyeri-blog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>