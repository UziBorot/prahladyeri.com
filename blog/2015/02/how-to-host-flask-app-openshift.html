<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <title>How to host a Flask app on Openshift</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Prahlad Yeri - Freelance Programmer Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Prahlad Yeri - Freelance Programmer </a></h1>
                <nav><ul>
				<li><a href="/">Home</a></li> <!--hard coded-->
                    <li><a href="/about">About</a></li>
                    <li><a href="/projects">Projects</a></li>
                    <li><a href="/hire-me">Hire Me</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/blog/2015/02/how-to-host-flask-app-openshift.html" rel="bookmark"
           title="Permalink to How to host a Flask app on Openshift">How to host a Flask app on Openshift</a></h1>
<a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="prahladyeri">Tweet</a><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-02-06T18:30:00+05:30">
                Published: Fri 06 February 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/prahlad-yeri.html">Prahlad Yeri</a>
        </address>
<p>In <a href="/category/uncategorized.html">Uncategorized</a>.</p>

</footer><!-- /.post-info -->      <p><a href="https://www.openshift.com/">Openshift free tier</a> is an excellent way to host your python web app for staging or testing, and you can even host a low to medium traffic production site. Openshift provides several options (cartridges) for hosting including <code class="highlighter-rouge">python, php, node.js, etc.</code> but <code class="highlighter-rouge">python</code> being my favorite language and <code class="highlighter-rouge">Flask</code> being a minimalist and flexible framework, this combination is what I usually end up with.<!--more--></p>
<h3>Create an Openshift account</h3>
<p>In case you haven’t already, head over to <a href="https://www.openshift.com/">Openshift</a> and sign up for a free tier. You will be able to host at most three apps for each account. Openshift apps are hosted on <code class="highlighter-rouge">rhcloud.com</code> domain and you’ll have to setup a subdomain first which will be part of your app url. For instance, if I register <code class="highlighter-rouge">prahladyeri.rhcloud.com</code> subdomain, I can create the following apps with that:</p>
<p>::: {.highlighter-rouge}</p>
<div class="highlight"><pre><span></span>myflaskapp-prahladyeri.rhcloud.com
myphpapp-prahladyeri.rhcloud.com
blog-prahladyeri.rhcloud.com
</pre></div>


<p>:::</p>
<h3>Install the necessary tools</h3>
<p>You will need the following:</p>
<ol>
<li><a href="git-scm.com/">Git</a>: Your app resides in a git repository, so you’ll need git installed on your machine to push changes. App is deployed automatically once you push.</li>
<li><a href="http://python.org">Python and Flask</a>: Obviously, you are going to need them if you are building a Flask app.</li>
<li><a href="https://rubygems.org/gems/rhc">Openshift rhc tool</a>: This <code class="highlighter-rouge">ruby</code> based tool is optional, only use it if you don’t want to use their online portal for creating apps or you aren’t familiar with ssh. Personally, I didn’t want to install <code class="highlighter-rouge">ruby</code> on my machine just for this one purpose.</li>
</ol>
<h3>Pull the remote repo</h3>
<p>Once you create a python app, Openshift will provide you a git repository url as follows:</p>
<p><img alt="Openshift git url" src="/uploads/old/openshift-git-repo.png"></p>
<p>Now open your command line and pull this starter repo to your local machine:</p>
<figure class="highlight">
      git clone <YOUR_SOURCE_URL> myFlaskApp

</figure>

<p>Now, the remote repository will be cloned in the <code class="highlighter-rouge">myFlaskApp</code> folder. Browse it to see the scaffolding.</p>
<h3>Add your flask app</h3>
<p>The scaffolding structure will be as follows:</p>
<figure class="highlight">
    wsgi.py
    setup.py
    .openshift/..
    .settings/..
    wsgi/..         => your python source files go here.
    wsgi/static..   => your static folders viz css, img, fonts, et al. go here.

</figure>

<p>If the wsgi/ folder doesn’t exist, you’ll have to create it. Just modify the setup.py and add Flask and SQLAlchemy as your app dependencies along with your app name. This tells openshift to make sure that dependency packages are available whenever you push any code changes.</p>
<figure class="highlight">

    from setuptools import setup

    setup(name='myFlaskApp',
          version='1.0',
          description='myFlaskApp',
          author='Prahlad Yeri',
          author_email='prahladyeri@yahoo.com',
          url='http://www.python.org/sigs/distutils-sig/',
          install_requires=['Flask==0.10.1','SQLAlchemy==0.9.8'],
         )

</figure>

<p>Now, create a text file named <code class="highlighter-rouge">application</code> in the wsgi/ folder with the following contents:</p>
<figure class="highlight">

    #!/usr/bin/python
    import os

    virtenv = os.environ['OPENSHIFT_PYTHON_DIR'] + '/virtenv/'
    os.environ['PYTHON_EGG_CACHE'] = os.path.join(virtenv, 'lib/python2.7/site-packages')
    virtualenv = os.path.join(virtenv, 'bin/activate_this.py')
    try:
        execfile(virtualenv, dict(__file__=virtualenv))
    except IOError:
        pass

    from myFlaskApp import app as application       

</figure>

<p>This is a configuration file that tells openshift where your Flask app script resides. Now create a python file called myFlaskApp.py, this will be your HelloWorld script:</p>
<figure class="highlight">

    import flask
    from flask import Flask
    from flask import request

    app = Flask(__name__)

    @app.route("/")
    def home():
        return "Hello World"

    if __name__ == "__main__":
        app.run(debug=True)

</figure>

<p>The last part of the code (app.run) is there so that you may test the Flask app by running this script on your local machine before pushing these changes.</p>
<h3>Push your changes</h3>
<p>All that is left to be done now is committing your changes and pushing them to openshift:</p>
<p>::: {.highlighter-rouge}</p>
<div class="highlight"><pre><span></span>git add .
git commit -m &quot;Initial commit for myFlaskApp&quot;
git push origin master
</pre></div>


<p>:::</p>
<h3>Voila! You are done</h3>
<p>Wasn’t it almost as easy as deploying a <code class="highlighter-rouge">php</code> script on your web host? If everything goes right, your Flask app will be hosted on <code class="highlighter-rouge">http://myFlaskApp-mydomain.rhcloud.com/</code>. Visit your app link and check it out.</p>
<h3>Few important things</h3>
<ul>
<li>In case you aren’t familiar about how git over ssl works, the remote machine authenticates your machine using an SSL public key you have already provided them. So if this is your fist time, you’ll have to generate a private-public key pair (using ssh in linux or putty on windows). After that, you’ll have to update your public key to Openshift, so they can authenticate your machine. You can add it using the Settings menu on the Openshift portal.</li>
<li>Its very important that all your static files reside in <strong>wsgi/static</strong> folder and that folder only. Openshift uses that path by default. But in case you are really stuck with using <code class="highlighter-rouge">/css</code> and <code class="highlighter-rouge">/js</code> in your existing app, as a solution you can clear the <code class="highlighter-rouge">static_url_path</code> in your flask app as follows:</li>
</ul>
<figure class="highlight">
      app = Flask(__name__, static_url_path='', static_folder='static')

</figure>

<p>Refer to this Openshift <a href="https://blog.openshift.com/build-your-app-on-openshift-using-flask-sqlalchemy-and-postgresql-92/">tutorial</a> for more details.</p>
<ul>
<li>Make the most of SSH. Some times, you may want to connect with the remote server using secured shell (ssh/putty) for troubleshooting, viewing logs, etc. Your SSH url is included in your git source url. So, if your git url is of the form:</li>
</ul>
<figure class="highlight">
          ssh://500XXXXXXXXXXXX01061a@prahladyeri-inn.rhcloud.com/~/git/prahladyeri.git/

</figure>

<p>Just remove the <code class="highlighter-rouge">ssh://</code> from the beginning and the other things after the domain, so the SSH host url becomes:</p>
<figure class="highlight">
          500XXXXXXXXXXXX01061a@prahladyeri-inn.rhcloud.com

</figure>

<p><em>References:</em></p>
<ul>
<li><a href="https://blog.openshift.com/build-your-app-on-openshift-using-flask-sqlalchemy-and-postgresql-92/">Build an app using Flask, SQLAlchemy and PostgreSQL</a></li>
<li><a href="https://rubygems.org/gems/rhc">Openshift rhc tool</a></li>
<li><a href="https://www.openshift.com/">Openshift Homepage</a></li>
</ul>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="mailto:prahladyeri@yahoo.com">Email</a></li>
                            <li><a href="https://github.com/prahladyeri/">Github</a></li>
                            <li><a href="https://stackoverflow.com/users/849365/prahlad-yeri/">StackOverflow</a></li>
                            <li><a href="https://www.quora.com/profile/Prahlad-Yeri-%E0%A4%AA%E0%A5%8D%E0%A4%B0%E0%A4%B9%E0%A5%8D%E0%A4%B2%E0%A4%BE%E0%A4%A6-%E0%A4%AF%E0%A5%87%E0%A4%B0%E0%A5%80">Quora</a></li>
                            <li><a href="https://mastodon.social/@prahladyeri">Mastodon.Social</a></li>
                            <li><a href="https://www.blogger.com/profile/12769325975373447545">Blogger</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/prahlad-yeri-243a5316">Linkedin</a></li>
                            <li><a href="https://www.facebook.com/prahladyeri14">Facebook</a></li>
                            <li><a href="https://twitter.com/prahladyeri">Twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Copyright (c) 2013-2019 <a href="/">Prahlad Yeri</a>.
				<br>
				This work is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/).
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'https://prahladyeri-blog.disqus.com';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>