<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <title>How To Enforce Conventional Commit Messages Using GIT Hooks</title>
        <link rel="stylesheet" href="https://prahladyeri.com/theme/css/main.css" />
        <link href="https://prahladyeri.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Prahlad Yeri - Freelance Programmer Atom Feed" />
		
	<meta name="twitter:card" content="summary" />
	 <meta name="twitter:site" content="@prahladyeri" />
	 <meta name="twitter:creator" value="@prahladyeri" />
		<meta name="twitter:url" content="https://prahladyeri.com/blog/2019/06/how-to-enforce-conventional-commit-messages-using-git-hooks.html" />
	 	 <meta name="twitter:title" content="How To Enforce Conventional Commit Messages Using GIT Hooks" />
		<meta name="twitter:description" content="Conventional git commit messages are not just nice to have but great to have. In fact, once you get to know them, you'll start feeling that they are essential in any serious programming project. Consider the difference between following two commig messages for instance: git commit -m "added social login â€¦" />		
			<meta name="twitter:image" content="https://prahladyeri.com/uploads/cover.jpg" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://prahladyeri.com/">Prahlad Yeri - Freelance Programmer </a></h1>
                <nav><ul>
				 <!--Start: hard coded-->
				<li ><a href="/">Home</a></li>
				<li  class="active"><a href="/blog/">Blog</a></li>
				<li ><a href="/projects/">Projects</a></li> 
				<li ><a href="/hire-me/">Hire Me</a></li> 
				<!--End: hard coded-->				
                    <!--li><a href="https://prahladyeri.com/">About</a></li-->
                    <!--li><a href="https://prahladyeri.com/projects/">Projects</a></li-->
                    <!--li><a href="https://prahladyeri.com/hire-me/">Hire Me</a></li-->
				<li><a href="https://github.com/prahladyeri/resume">Resume</a></li> <!--hard coded-->
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://prahladyeri.com/blog/2019/06/how-to-enforce-conventional-commit-messages-using-git-hooks.html" rel="bookmark"
           title="Permalink to How To Enforce Conventional Commit Messages Using GIT Hooks">How To Enforce Conventional Commit Messages Using GIT Hooks</a></h1>
<a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="prahladyeri">Tweet</a><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-06-14T11:58:00+05:30">
                Published: Fri 14 June 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://prahladyeri.com/">Prahlad Yeri</a>
        </address>
<p>In <a href="https://prahladyeri.com/category/linux.html">Linux</a>.</p>
<p>tags: <a href="https://prahladyeri.com/tag/git.html">Git</a> <a href="https://prahladyeri.com/tag/open-source.html">Open Source</a> </p>
</footer><!-- /.post-info -->      <p><a href="https://www.conventionalcommits.org/en/v1.0.0-beta.4/">Conventional git commit messages</a> are not just nice to have but great to have. In fact, once you get to know them, you'll start feeling that they are essential in any serious programming project. Consider the difference between following two commig messages for instance:</p>
<div class="highlight"><pre><span></span>git commit -m &quot;added social login feature for authentication using twitter&quot;
git commit -m &quot;feat(authentication): added social login using twitter&quot;
</pre></div>


<p>The second one is not only more readable but it also follows standards which makes it easier to integrate with build tools such as Travis CI and Appveyor. Not just that, you can easily automate <code>CHANGELOG</code> generation when your <code>git log</code> looks like this:</p>
<div class="highlight"><pre><span></span>&gt; git log --oneline
61c8ca9 (HEAD -&gt; master) fix: navbar not responsive on mobile
479c48b test: prepared test cases for user authentication
a992020 chore: moved to semantic versioning
b818120 fix: button click even handler firing twice
c6e9a97 fix: login page css
dfdc715 feat(authentication): added social login using twitter
</pre></div>


<p>All in all, I like conventional commit messages so much that I don't want to keep it optional but make it the default way of life. How do I do it? The answer is simple: <em>git hooks</em>.</p>
<p>You don't need to be a git ninja or expert to work with hooks. Suffice it to know that inside your special git repository folder (named <code>.git</code>), there are some other special folders:</p>
<div class="highlight"><pre><span></span>logs
hooks
objects
refs
</pre></div>


<p>The one we are interested in is <code>hooks</code>. To get the hang of it, create a test project on your machine and initialize an empty git repository by running:</p>
<div class="highlight"><pre><span></span>git init .
</pre></div>


<p>Now visit the <code>.git</code> folder just generated and navigate to the hooks folder. There will be a bunch of scripts with <code>.sample</code> extension (which means they are all disabled). The one we are interested in is <code>commit-msg</code>. This is the hook that fires just before your commit is made and thus allows you to reject the commit by throwing an error if the message isn't in proper format.</p>
<p>Create a new script in this directory named <code>commit-msg</code> and add the below code (you'll need python installed) to it using your favorite editor (mine is notepad++!):</p>
<div class="highlight"><pre><span></span><span class="n">C</span><span class="o">&amp;</span><span class="c1">#35;!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># example:</span>
    <span class="c1"># feat(apikey): added the ability to add api key to configuration</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(build|ci|docs|feat|fix|perf|refactor|style|test|chore|revert)(\([\w\-]+\))?:\s.*&#39;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;conventional commit validation failed&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>


<p>Save the script and make it executable (by running <code>chmod u+x commit-msg</code> on linux, not required on windows). Now head back to your source code folder where you initialized the git repo and create a source file just for testing. Then, <code>git add</code> and try to commit just for testing using a non-conventional message. If all goes well, it should fail like this!</p>
<div class="highlight"><pre><span></span>&gt; git commit -m &quot;added a new feature for xyz&quot;
Traceback (most recent call last):
  File &quot;C:/Users/localadmin/Documents/scripts/check_commit.py&quot;, line 14, in &lt;module&gt;
    main()
  File &quot;C:/Users/localadmin/Documents/scripts/check_commit.py&quot;, line 11, in main
    if m == None: raise Exception(&quot;conventional commit validation failed&quot;)
Exception: conventional commit validation failed
</pre></div>


<p>Now test with a valid commit message and it should work!</p>
<p>Once you practice this a few times and get a hang over it, you'll then want to make this behavior default for whatever projects you start using <code>git init</code> in future, isn't it? Sure, you can do that by creating a global git commit hook template but that will be a post for another day. First things first!</p>
<p>References:</p>
<ul>
<li><a href="https://www.conventionalcommits.org/en/v1.0.0-beta.4/">https://www.conventionalcommits.org/en/v1.0.0-beta.4/</a></li>
<li><a href="https://stackoverflow.com/questions/3523534/good-ways-to-manage-a-changelog-using-git">https://stackoverflow.com/questions/3523534/good-ways-to-manage-a-changelog-using-git</a></li>
<li><a href="https://stackoverflow.com/questions/37699261/how-to-validate-and-display-error-for-git-commit-message">https://stackoverflow.com/questions/37699261/how-to-validate-and-display-error-for-git-commit-message</a></li>
<li><a href="https://coderwall.com/p/jp7d5q/create-a-global-git-commit-hook">https://coderwall.com/p/jp7d5q/create-a-global-git-commit-hook</a></li>
</ul>
    </div><!-- /.entry-content -->
	
	<!-- Start: Prahlad -->
	<!--start: adsense-->
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- mainsite_responsive -->
	<ins class="adsbygoogle"
		 style="display:block"
		 data-ad-client="ca-pub-0428291735937735"
		 data-ad-slot="6897031752"
		 data-ad-format="auto"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	<!--end: adsense-->
	<!-- End: Prahlad -->

    <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
		<script>
		/**
		*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
		
		/*var disqus_config = function () {
			this.page.url = 'https://prahladyeri.com/blog/2019/06/how-to-enforce-conventional-commit-messages-using-git-hooks.html';  // Replace PAGE_URL with your page's canonical URL variable
			this.page.identifier = 'blog/2019/06/how-to-enforce-conventional-commit-messages-using-git-hooks.html'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
		};
		(function() { // DON'T EDIT BELOW THIS LINE
		var d = document, s = d.createElement('script');
		s.src = 'https://prahladyeri-blog.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
		})();*/
		</script>	  
	  
      <script type="text/javascript">
        var disqus_shortname = 'prahladyeri-blog';
        var disqus_identifier = 'blog/2019/06/how-to-enforce-conventional-commit-messages-using-git-hooks.html';
        var disqus_url = 'https://prahladyeri.com/blog/2019/06/how-to-enforce-conventional-commit-messages-using-git-hooks.html';
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//prahladyeri-blog.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="mailto:prahladyeri@yahoo.com">Email</a></li>
                            <li><a href="https://github.com/prahladyeri/">Github</a></li>
                            <li><a href="https://stackoverflow.com/users/849365/prahlad-yeri/">StackOverflow</a></li>
                            <li><a href="https://www.quora.com/profile/Prahlad-Yeri">Quora</a></li>
                            <li><a href="https://mastodon.social/@prahladyeri">Mastodon.Social</a></li>
                            <li><a href="https://www.blogger.com/profile/12769325975373447545">Blogger</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://prahladyeri.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/prahlad-yeri-243a5316">Linkedin</a></li>
                            <li><a href="https://www.facebook.com/prahladyeri14">Facebook</a></li>
                            <li><a href="https://twitter.com/prahladyeri">Twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Copyright (c) 2013-2019 <a href="/">Prahlad Yeri</a>.
				<br>
				This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-6808883-5', 'auto');
    ga('send', 'pageview');
    </script>
<script type="text/javascript">
    var disqus_shortname = 'prahladyeri-blog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>